package com.drinkscabinet.aoc2020

import GridString
import UpDown
import com.drinkscabinet.Coord
import com.drinkscabinet.Utils

private fun main() {
    val tiles = parse(input)
//    tiles.forEach { println(it)    }

    val matchCount = mutableMapOf<Int, Int>()

    for (tile in tiles.values) {
        val matches = tiles.values.count { tile.id != it.id && tile.canMatch(it) }
        println("Tile ${tile.id} matches $matches")
        matchCount[tile.id] = matches
    }

    println("There are ${matchCount.count { it.value == 2 }} 2-Matches")
    println("There are ${matchCount.count { it.value == 3 }} 3-Matches")
    println("There are ${matchCount.count { it.value == 4 }} 4-Matches")
    println("There are ${matchCount.count { it.value == 5 }} 5-Matches")
    val tiles2 = matchCount.filter { it.value == 2 }
    val result = tiles2.map { it.key.toLong() }.fold(1L, { a, b -> a * b })
    println("Part1=$result")

    val monster = GridString.parse(seaMonster)
    println(monster.toString(true))

    val monsters = mutableListOf<GridString>()
    for (i in 0..3) {
        monsters.add(monster.copyOf().rotate90(i).normalise())
    }
    for (i in 0..3) {
        monsters.add(monster.copyOf().flipH().rotate90(i).normalise())
    }

    monsters.forEach { println(it.toString(true)) }

    // start stitching
    // pick a 2-match
    println(tiles2)
    val start = tiles[tiles2.keys.first()]!!

    println("starting with ${start.id}")
    val allTiles = tiles.values.toSet().minus(start)
    println(sidesWithMatches(start, allTiles))
    // get R=56
    val start2 = start.exactMatch(UpDown.R, 56)!!
    println(sidesWithMatches(start2, allTiles))

    // OK this is our starting point - build grid from here
    val assembled = mutableMapOf(Coord(0, 0) to start2)
    // Remaining tiles to be placed
    val remainingTilesets = allTiles.toMutableSet()
    // build it row by row
    for (y in 0..11) {
        for (x in 0..11) {
            val c = Coord(x, y)
            if (assembled.containsKey(c)) continue
            if (x == 0) {
                // only worry about sig above
                val aboveSig = assembled[Coord(x, y - 1)]!!.currentSignatures[UpDown.D]!!
                val match = remainingTilesets.filter { it.allSignatures.contains(aboveSig) }
                if (match.size != 1) {
                    throw Exception("Unexpected match size ${match.size}")
                }
                assembled[c] = match[0].exactMatch(UpDown.U, aboveSig)!!
                remainingTilesets.remove(match[0])
            } else if (y == 0) {
                // only worry about sig to left
                val leftSig = assembled[Coord(x - 1, y)]!!.currentSignatures[UpDown.R]!!
                // Find match
                val match = remainingTilesets.filter { it.allSignatures.contains(leftSig) }
                if (match.size != 1) {
                    throw Exception("Unexpected match size ${match.size}")
                }
                assembled[c] = match[0].exactMatch(UpDown.L, leftSig)!!
                remainingTilesets.remove(match[0])
            } else {
                // worry about left and above sig
                val aboveSig = assembled[Coord(x, y - 1)]!!.currentSignatures[UpDown.D]!!
                val leftSig = assembled[Coord(x - 1, y)]!!.currentSignatures[UpDown.R]!!
                val match =
                    remainingTilesets.filter { it.allSignatures.contains(leftSig) && it.allSignatures.contains(aboveSig) }
                if (match.size != 1) {
                    throw Exception("Unexpected match size ${match.size}")
                }
                assembled[c] = match[0].exactMatch(UpDown.L, leftSig)!!
                remainingTilesets.remove(match[0])
            }
        }
    }
    // Did we get here?
    println(assembled[Coord(11, 11)])

    // Phew!
    // now build the overall grid
    val megaGrid = GridString()
    for (entry in assembled) {
        val translateBy = Coord(entry.key.x * 8, entry.key.y * 8)
        val points = entry.value.grid.getAll('#').filter { it.x in 1..8 && it.y in 1..8 }
        // translate and add to megagrid
        points.map { it.move(translateBy) }.forEach { megaGrid.add(it, '#') }
    }
    println("Complete: ")
    println(megaGrid)
}

private fun sidesWithMatches(tile: Tileset, tiles: Set<Tileset>): Map<UpDown, Int> {
    // find the tiles that match this
    val matchingTiles = tiles.filter { it.canMatch(tile) }
    val possibleSigs = matchingTiles.flatMap { it.allSignatures }.toSet()
    // now which sides match them
    val def = tile.defaultSignatures
    return def.filter { possibleSigs.contains(it.value) }.toMap()
}

private fun sidesWithMatches(tile: Tile, tiles: Set<Tileset>): Map<UpDown, Int> {
    // find the tiles that match this
    val matchingTiles = tiles.filter { it.canMatch(tile) }
    val possibleSigs = matchingTiles.flatMap { it.allSignatures }.toSet()
    // now which sides match them
    val def = tile.currentSignatures
    return def.filter { possibleSigs.contains(it.value) }.toMap()
}

private fun parse(s: String): Map<Int, Tileset> {

    val tiles = s.lines().chunked(12).map { Tile.parse(it) }.toList()
    return tiles.map { it.id to Tileset(it.id, it.grid) }.toMap()
}

data class Tileset(val id: Int, val grid: GridString) {

    private val orientations = listOf(
        Tile(id, grid.copyOf().normalise()),
        Tile(id, grid.copyOf().rotate90(1).normalise()),
        Tile(id, grid.copyOf().rotate90(2).normalise()),
        Tile(id, grid.copyOf().rotate90(3).normalise()),
        Tile(id, grid.copyOf().flipH().normalise()),
        Tile(id, grid.copyOf().flipH().rotate90(1).normalise()),
        Tile(id, grid.copyOf().flipH().rotate90(2).normalise()),
        Tile(id, grid.copyOf().flipH().rotate90(3).normalise()),
    )

    val allSignatures = orientations[0].allSignatures

    val defaultSignatures = orientations[0].currentSignatures

    fun canMatch(other: Tileset): Boolean {
        return orientations[0].canMatch(other.orientations[0])
    }

    fun canMatch(other: Tile): Boolean {
        return orientations[0].canMatch(other)
    }

    fun exactMatch(side: UpDown, signature: Int): Tile? {
        return orientations.find { it.currentSignatures[side] == signature }
    }

}


data class Tile(val id: Int, val grid: GridString) {

    val top = grid.getAll('#').filter { it.y == 0L }.map { powers[it.x.toInt()] }.sum()
    val bottom = grid.getAll('#').filter { it.y == 9L }.map { powers[it.x.toInt()] }.sum()
    val left = grid.getAll('#').filter { it.x == 0L }.map { powers[it.y.toInt()] }.sum()
    val right = grid.getAll('#').filter { it.x == 9L }.map { powers[it.y.toInt()] }.sum()

    val currentSignatures = mapOf(UpDown.U to top, UpDown.D to bottom, UpDown.L to left, UpDown.R to right)

    val topI = grid.getAll('#').filter { it.y == 0L }.map { powers[9 - it.x.toInt()] }.sum()
    val bottomI = grid.getAll('#').filter { it.y == 9L }.map { powers[9 - it.x.toInt()] }.sum()
    val leftI = grid.getAll('#').filter { it.x == 0L }.map { powers[9 - it.y.toInt()] }.sum()
    val rightI = grid.getAll('#').filter { it.x == 9L }.map { powers[9 - it.y.toInt()] }.sum()

    val signatures = listOf(top, right, bottom, left)
    val signaturesI = listOf(topI, rightI, bottomI, leftI)
    val allSignatures = setOf(top, right, bottom, left, topI, rightI, bottomI, leftI)

    fun canMatch(other: Tile): Boolean {
        return allSignatures.intersect(other.allSignatures).isNotEmpty()
    }

    companion object {
        fun parse(s: List<String>): Tile {
            val id = Utils.extractInts(s[0])[0]
            val grid = GridString.parse(s.subList(1, 11))
            return Tile(id, grid)
        }

        private val powers: IntArray = intArrayOf(1, 2, 4, 8, 16, 32, 64, 128, 256, 512, 1024, 2048)
    }
}

private val seaMonster = """
                  # 
#    ##    ##    ###
 #  #  #  #  #  #       
"""

private val testInput = """
    Tile 2311:
    ..##.#..#.
    ##..#.....
    #...##..#.
    ####.#...#
    ##.##.###.
    ##...#.###
    .#.#.#..##
    ..#....#..
    ###...#.#.
    ..###..###

    Tile 1951:
    #.##...##.
    #.####...#
    .....#..##
    #...######
    .##.#....#
    .###.#####
    ###.##.##.
    .###....#.
    ..#.#..#.#
    #...##.#..

    Tile 1171:
    ####...##.
    #..##.#..#
    ##.#..#.#.
    .###.####.
    ..###.####
    .##....##.
    .#...####.
    #.##.####.
    ####..#...
    .....##...

    Tile 1427:
    ###.##.#..
    .#..#.##..
    .#.##.#..#
    #.#.#.##.#
    ....#...##
    ...##..##.
    ...#.#####
    .#.####.#.
    ..#..###.#
    ..##.#..#.

    Tile 1489:
    ##.#.#....
    ..##...#..
    .##..##...
    ..#...#...
    #####...#.
    #..#.#.#.#
    ...#.#.#..
    ##.#...##.
    ..##.##.##
    ###.##.#..

    Tile 2473:
    #....####.
    #..#.##...
    #.##..#...
    ######.#.#
    .#...#.#.#
    .#########
    .###.#..#.
    ########.#
    ##...##.#.
    ..###.#.#.

    Tile 2971:
    ..#.#....#
    #...###...
    #.#.###...
    ##.##..#..
    .#####..##
    .#..####.#
    #..#.#..#.
    ..####.###
    ..#.#.###.
    ...#.#.#.#

    Tile 2729:
    ...#.#.#.#
    ####.#....
    ..#.#.....
    ....#..#.#
    .##..##.#.
    .#.####...
    ####.#.#..
    ##.####...
    ##..#.##..
    #.##...##.

    Tile 3079:
    #.#.#####.
    .#..######
    ..#.......
    ######....
    ####.#..#.
    .#...#.##.
    #.#####.##
    ..#.###...
    ..#.......
    ..#.###...
""".trimIndent()

private val input = """
    Tile 2053:
    ......#.#.
    #....#....
    #.#.......
    .##.#..#.#
    .##...####
    #.#....#.#
    ##.##.#.#.
    ...##.....
    ####.##..#
    #..##...##

    Tile 1543:
    .####.##..
    .......#.#
    ..........
    ..#.......
    #......#..
    #....##...
    #.#....#..
    #..##....#
    #.#..#....
    #.#...####

    Tile 2441:
    .##.#..##.
    #..#......
    ..#...#.##
    ...#.....#
    #..##.....
    ......##..
    ###.#....#
    ##...#.#..
    ...#...###
    .#..#.##.#

    Tile 3733:
    ..#..#....
    ..#.#.....
    ......#.##
    .#..#.##.#
    ..#....#..
    ......#..#
    .###.#....
    .#.#..#..#
    .#....#...
    #..#..##..

    Tile 2237:
    ###.....#.
    #..#.....#
    ........#.
    #.#.......
    #........#
    ##...#...#
    ..#.......
    #.......##
    ##..#....#
    ...###...#

    Tile 2203:
    ##..#....#
    .....##...
    ...#....##
    .........#
    ##....#..#
    #.#..#.#..
    .......###
    .#....#..#
    ......###.
    ...#..#.##

    Tile 1783:
    #...##..#.
    ........#.
    #..#.###.#
    ....#.##..
    ....#....#
    ..#.#....#
    .........#
    ##.#.....#
    #.#.....##
    #....#..#.

    Tile 1487:
    #.....#...
    #..#.#...#
    ..........
    .........#
    #.....##.#
    ....###.##
    ##...#...#
    ##......##
    ........#.
    ....#####.

    Tile 3209:
    ...#....##
    #...##..#.
    ..#.....##
    #.##...###
    ...#..##.#
    ..#..#....
    ......#.#.
    ..........
    .##...##.#
    #..##.####

    Tile 2557:
    #......#.#
    ...#......
    ##.###.#..
    .###....##
    #.........
    ....#.#...
    .#..###..#
    ...#...##.
    .#.....#.#
    .###.##.#.

    Tile 1009:
    ###.##....
    ###.#..#.#
    #.#....#..
    .....##.##
    ...#.#....
    ..#.##.#..
    #..##.#.##
    #..#......
    #..#...#.#
    #..#.#..##

    Tile 1361:
    #..#..###.
    ....#...#.
    ##.#....##
    ......#..#
    .........#
    ##..##...#
    #...##...#
    #...#.....
    ..##....##
    #..#..####

    Tile 2767:
    .#.###.###
    #.#.......
    ...#...##.
    #..#...#..
    #.#...#...
    .#........
    ##....#...
    #....#.#..
    #.......#.
    #.#.#..#..

    Tile 1109:
    .#..#..#.#
    .....#..#.
    ......#..#
    ..##...#..
    ...#.#..##
    ...#.#..##
    ......##..
    #...#..#..
    #...#.....
    ..#.#.#.#.

    Tile 1493:
    ###..####.
    ....##...#
    #..#.#....
    ##.....#..
    #..#.#..#.
    #.........
    #...#.#.#.
    #.#..#.#.#
    ##.....#.#
    #.#.#.###.

    Tile 2971:
    #####...#.
    ....#.....
    #.......##
    ..#.#...##
    ...#.##..#
    ###.#..###
    #......#.#
    ..........
    ...#..#...
    .....#..##

    Tile 2909:
    .######.##
    ###..#...#
    #....###..
    #.####...#
    ..#.##....
    #.........
    ..#.#....#
    .#.##.##..
    ##.###.#.#
    ...##..#..

    Tile 2551:
    .#.##.#.#.
    ###.#..##.
    #.......#.
    ##.......#
    ..###.....
    #.##..#...
    #.##....#.
    #......#.#
    ......#.##
    #.#...#..#

    Tile 2917:
    ..###.##..
    ..#...#..#
    #........#
    #....##.##
    #.........
    ...##.....
    .###...##.
    #.#...##..
    .#.#.#.##.
    .#.#..####

    Tile 1553:
    ..##..#..#
    #..#...#.#
    #.#....#.#
    ##........
    .###...#..
    #.##.##.##
    .....#..#.
    #.....##..
    .......#.#
    ##.#.#.##.

    Tile 2297:
    .##.##.#..
    .##.#..##.
    ...#.#.###
    ...##...##
    .#..##..##
    ##.#......
    ...#.....#
    #.#.#...#.
    .#......##
    ....#.##.#

    Tile 1789:
    ####....#.
    #.#.#..#..
    ...##.####
    ##.#.#...#
    .###.....#
    .#.#...##.
    #...##.#..
    ##...#...#
    ..#.......
    #######...

    Tile 3079:
    #.##..#.#.
    #........#
    ..#..#....
    ..#..###.#
    .......#.#
    #....#####
    #......##.
    #..##.#...
    #.......#.
    ###..##.##

    Tile 3037:
    ..####.###
    ....##.#..
    .......##.
    ....#...#.
    ..#.#.....
    .#......##
    ##....##..
    #..#.#.#..
    ##......##
    ###..###..

    Tile 2677:
    ##.#..#...
    .#........
    ..###..#.#
    ..##.....#
    .##....#.#
    #.#...#..#
    ......#.##
    .......#.#
    ..........
    #.#.#..###

    Tile 1129:
    .##.#.#.##
    .........#
    #.##.#....
    .#...##..#
    .#...#...#
    ..#..#.#..
    ##..#....#
    ##........
    ..#.##.###
    ##..#.####

    Tile 2647:
    .......#..
    #........#
    .....#.#..
    .......##.
    ##..#.....
    .#.###..#.
    #....#.##.
    #.#....#..
    #.#..#...#
    ..##.###.#

    Tile 2531:
    #.#.##..##
    ##..#...#.
    ..#.......
    ##.......#
    ..........
    .....#...#
    #..###...#
    #........#
    #.........
    .####..##.

    Tile 1663:
    .#.#..#...
    ..#...#...
    ##...##.#.
    ...#...#..
    .##....#..
    #........#
    ...#...#..
    ##....#..#
    #.....#...
    .####.##..

    Tile 1193:
    #......##.
    ..#.#.###.
    #..#.....#
    #.##.....#
    .....#..##
    ....#.#..#
    #..#.....#
    ..........
    ...###....
    #..#.#.###

    Tile 2477:
    .#...#.##.
    #....##..#
    #.##.#...#
    ##..#.....
    .........#
    ..#..#...#
    .##...#.##
    #.###.....
    #..##.....
    ..#.##.#.#

    Tile 2083:
    .#.#.#.#..
    ###.#.....
    .....#..##
    ...#.#....
    #.......#.
    .#.###....
    #.#.#.....
    .##..#.#.#
    #.##.....#
    ..##.#.##.

    Tile 2897:
    ###.####..
    ..##....##
    ###...#...
    .......#..
    #..#.#..#.
    .....###..
    ......##..
    ....##..#.
    .#...##..#
    #.....#..#

    Tile 3797:
    #.....#...
    ..#.####.#
    #....#.#..
    #.....#.##
    ##..#.....
    #....#..##
    ...#...#.#
    .#....####
    ##.##.###.
    ###.#.#...

    Tile 2087:
    #####....#
    ..##...##.
    ...#......
    .##......#
    #..#....#.
    .#..#....#
    ..##......
    #........#
    #.......#.
    #.#.##...#

    Tile 2447:
    #.##....#.
    ##........
    ##........
    #.#...#..#
    ##.#...#..
    #..#..##.#
    #........#
    ........#.
    #...#....#
    #.....#.##

    Tile 1511:
    #...#####.
    ..#.......
    .........#
    ..#......#
    ###.......
    .....#..##
    #..#.....#
    #.##.#....
    ......#..#
    ###.#.#.##

    Tile 1249:
    #.#..##...
    #...#.#.#.
    ......#..#
    #....##...
    ....#.##..
    .#..##...#
    #....###..
    #....#....
    .....#...#
    ...###.##.

    Tile 2741:
    ###..#..#.
    #.##.#...#
    #...#....#
    .....#...#
    #.....#.#.
    #.##.#...#
    #.#..#...#
    ......#.#.
    #...#..#..
    ..####.#..

    Tile 3607:
    #.#####..#
    #..#.#.#.#
    .......##.
    #........#
    #.#..#....
    #..##.####
    ...#..#.#.
    ........##
    ..#...#.#.
    ...#..#..#

    Tile 3877:
    ###..##...
    ##...#....
    #.........
    ........##
    #....#...#
    #...#....#
    .....#....
    ...#...#.#
    #..#.#...#
    .##...###.

    Tile 1277:
    ..#....#.#
    ####..#...
    #.........
    ..........
    #...#..##.
    ...#.#...#
    #........#
    ....#.....
    ...#..#..#
    ##.#....##

    Tile 3491:
    ..#...##..
    .........#
    #.........
    ...#......
    ...#..#.##
    #...##....
    #....#.#..
    #....##...
    ..#.#..#.#
    #.#.#.#.#.

    Tile 2011:
    ..##...##.
    ....#.#..#
    #..#....##
    ..........
    ..........
    .....#...#
    #..#.#...#
    ........##
    .#.......#
    ##.......#

    Tile 1087:
    #.#.#.#.#.
    ..#..#..##
    #.###.....
    #...#..#.#
    #....#...#
    #....#...#
    ..##..#.##
    #...##....
    ##........
    #......##.

    Tile 3307:
    #..##..#.#
    ...#######
    #......###
    ..#......#
    #....##..#
    .#.#.#...#
    #........#
    #.......##
    ..#..#...#
    #.#..##.#.

    Tile 1949:
    #.###..##.
    #.#......#
    #....#.##.
    ##......#.
    #.......##
    #.##.#...#
    .##....#..
    ..........
    ...###....
    ..#..##..#

    Tile 1061:
    ...#..#..#
    #.....#..#
    ##.#....##
    .#....#..#
    ..........
    #.......##
    .#.#.....#
    ..........
    #.#...#.#.
    ........#.

    Tile 1429:
    ##.#####..
    .#........
    #....#....
    ...#......
    #........#
    ##.....#.#
    ....##.#..
    ....#..##.
    #...#....#
    ###.#.##.#

    Tile 2221:
    ###.#.....
    #.......#.
    ....##.#.#
    ........##
    ..#..#....
    ..###....#
    #........#
    ##.#.#....
    #...#...##
    ##.######.

    Tile 1117:
    ..#.##.#.#
    ##.......#
    ..#.#.....
    .##......#
    .##..#....
    .........#
    ..#.......
    ##.#.#.#.#
    #.#.......
    #.#..#...#

    Tile 1571:
    ..##.##..#
    ...#...#.#
    #.##......
    #..#......
    ..#..#...#
    #.......##
    ...##....#
    ..#.#....#
    #.#..#..##
    .##..#.#..

    Tile 2969:
    .##..#..#.
    ..........
    #......#..
    #...#....#
    ..........
    ..##.#.###
    .....#....
    .......#.#
    ####..#.#.
    ..##..#...

    Tile 2713:
    ####.##.#.
    #.##.#.#..
    #...##....
    #......#..
    #.##.#....
    #.........
    ..##...#.#
    #...#.#.#.
    #.......##
    ..####..##

    Tile 3121:
    ....#.##..
    ..#......#
    ..#..##...
    #.#......#
    #....#..##
    ....##...#
    #..#.#....
    #.....#..#
    ..#...#.#.
    .#..####.#

    Tile 3673:
    .#.##..###
    ..#.#.....
    ...#..#..#
    ..........
    .##....###
    #..#...#..
    #..##..#..
    #...#.....
    ##.#..#..#
    ....##.###

    Tile 2683:
    ..#...#.##
    ..#..##.##
    ###..#....
    ###..#..##
    .......#..
    ..##.....#
    #.....#..#
    #.###.#.#.
    #.#.#.###.
    ..#.#...#.

    Tile 2617:
    .#...#....
    .......###
    .##..#....
    ..#..###.#
    #..##..#.#
    #.#.###..#
    ..#..###.#
    .#....#..#
    ##....#.##
    ..#.#..###

    Tile 2341:
    ......###.
    ..#..#....
    ..#.#...#.
    ..#.#.###.
    ...##.#..#
    ##......#.
    .........#
    #..#...#..
    #.......##
    ###...#...

    Tile 1609:
    ..##.#.#..
    #.......##
    #......#.#
    #.......#.
    ..##...#..
    ...#.#....
    ##......#.
    .###...#..
    .#....#..#
    ....#####.

    Tile 3299:
    #####.####
    .##.....#.
    ..#...#...
    ...#....#.
    #..#.#...#
    #...#...##
    #.....##.#
    ....#.##..
    ##....#...
    .##..##.#.

    Tile 1259:
    ##.#......
    ........#.
    .....#.###
    ....#.#.##
    #.....#.##
    ..#....#.#
    ..........
    .##.##...#
    ....##..#.
    ...#...#..

    Tile 2803:
    .#..#.#..#
    #...###..#
    ..###.####
    #....#.#.#
    ##.......#
    #.#.#.#...
    .#.#.#.#.#
    #....#....
    ....#....#
    ...###..#.

    Tile 1063:
    .#.##.##.#
    ......#.##
    .#..#.##..
    #....###..
    ....###...
    .##....#.#
    #.#.#....#
    .....#..#.
    ##......##
    .######..#

    Tile 2113:
    ..#.######
    ####.....#
    #.#....##.
    ........##
    #.#.....##
    ...#.....#
    #.........
    #.....#..#
    ##.##.#.##
    .##.###.##

    Tile 1531:
    .###..#.##
    #.....##.#
    .......#.#
    ........##
    #.....#...
    #.#.#...#.
    ..#...#..#
    ##.##.##..
    ..........
    #...#...##

    Tile 1289:
    ##.###.###
    ....#..#..
    ####....##
    #.#....#..
    #.........
    #.#....#.#
    ...#......
    .##.......
    ##..#.....
    ...##.####

    Tile 3529:
    ###..#.#.#
    #..###....
    ....#...##
    .#....###.
    ##...#....
    #.##.#.#..
    ####..#.#.
    #....#....
    #.##.##..#
    #.##.#....

    Tile 2389:
    .##.##.#..
    #.###...##
    ..##....##
    #.###.#...
    #.#......#
    .#......##
    ##..#.#..#
    #..#......
    ..###.....
    #.#####..#

    Tile 3727:
    #.#.##..#.
    ##.###.###
    #....##...
    #....#...#
    ..##.....#
    ......#.#.
    #.....#...
    ..........
    #..#....##
    .#.##.#...

    Tile 1013:
    ##.#.#####
    #.####...#
    #..#....#.
    #....##...
    ........##
    .#.#.#....
    #..#..##..
    #.#.#.###.
    ...##..##.
    ##.###...#

    Tile 3373:
    .##..#.###
    .....#....
    ...#..#...
    #...#....#
    #..####..#
    #...#.##.#
    .....##.##
    ....#.....
    ...##....#
    .#..###...

    Tile 3041:
    .#..#.####
    ..........
    .........#
    ..#.....#.
    .....#....
    #..#....#.
    .......#.#
    ..#......#
    ....#..#..
    ..####..##

    Tile 1627:
    .###.#...#
    ...#..#.##
    #...###..#
    ..#.......
    ##...##...
    #.....####
    ##........
    #..#......
    #.##.....#
    ...#...#.#

    Tile 1297:
    #..#...#.#
    #.........
    ..#.#..#..
    ..#......#
    .#..##...#
    ....#..#.#
    #...###...
    #...#....#
    #..#..#..#
    ##..#.#..#

    Tile 1787:
    ####.....#
    .....##..#
    ..........
    #...#.....
    ..........
    ..#..#.#..
    #..#..###.
    #......##.
    ...##..#..
    ##.....###

    Tile 3109:
    ##.###..##
    .#.#......
    .#.......#
    #.........
    #.#..#.#..
    #.#....#..
    #.....#..#
    ........##
    ##..#....#
    ##.###..#.

    Tile 3541:
    .##.####.#
    .....#.#.#
    #.........
    .#.##...##
    ..........
    #.......##
    .#......##
    .....###.#
    ##...##...
    .#...#.##.

    Tile 3347:
    ....##.#.#
    ..#..#..##
    .#..#.##.#
    ....#.....
    ....#.....
    #.....##.#
    #....#....
    ##....#...
    .#.......#
    ####.##.##

    Tile 1721:
    ###.#.##.#
    ##..#.....
    #.......#.
    .#..##..#.
    #.##....##
    ...#....##
    ##...#..#.
    #.#.#.#...
    #.#...#.##
    ..########

    Tile 1847:
    #...##.#.#
    ..#...#...
    ##........
    .##......#
    ........##
    .#.#.#....
    .##.#....#
    #..#......
    .#..#..###
    .#.##..###

    Tile 3329:
    ###......#
    ##....#...
    #.........
    ##.#.##.##
    #.#.......
    ..........
    ##......#.
    ...#...###
    #...#..##.
    #......#..

    Tile 3881:
    .#.#..##..
    ##..#...#.
    .......#..
    #.#..#...#
    #.#..#..##
    #..##.##.#
    #...#..#.#
    #..#......
    ..#...#.#.
    .####..###

    Tile 1709:
    #####.#.#.
    .#.##..###
    ##..##...#
    #####....#
    #..#......
    ....#..#..
    #...#.#...
    #...#.#...
    #..#.....#
    #..#.####.

    Tile 1171:
    ...#.#.#.#
    #.....#...
    #..#......
    .......##.
    .....#....
    #...#...#.
    #........#
    #....#....
    ..#......#
    ...#.#.#..

    Tile 1499:
    ########.#
    #..#.###.#
    ...#.###..
    #......#.#
    ###......#
    ...#......
    #...##.#..
    ....#.#..#
    ###.#.#...
    ####.##..#

    Tile 1283:
    .##.###.#.
    #.........
    ..#..##.##
    ....#.....
    #.#.##..#.
    .##...#..#
    #........#
    ....#...##
    .....##..#
    #.#.###..#

    Tile 1637:
    .#.##.###.
    ....#.....
    #..##.##..
    .###...##.
    ####.....#
    ##.....#..
    #.....##..
    #.#.##.#..
    #........#
    #.#.###.#.

    Tile 3911:
    ##.###....
    #.#.##....
    .#...#...#
    .#.#.#...#
    .#.....#..
    ##....##..
    #.........
    ..#.#.....
    ##....#..#
    ##..###...

    Tile 3259:
    ...#...#.#
    ...#..#..#
    #.#.###...
    #..#...#.#
    #....###.#
    ....#.....
    .#....#..#
    #........#
    #....#..##
    ##...#.##.

    Tile 2099:
    ##.##..###
    .....#.###
    ...##..#.#
    ..#.......
    .###.#...#
    ..##.#.#..
    #.#.......
    #.##.....#
    ...#..###.
    .##..#.#..

    Tile 1237:
    .##..###..
    ###..#....
    #...#.#...
    #......#..
    .....#..#.
    ......##..
    #...#.....
    #.........
    .#......##
    ...##.##..

    Tile 1987:
    #..#.#.###
    ...#...#..
    #.#....#.#
    ..#...#...
    ....#..##.
    #........#
    .#.#.#..#.
    #....###.#
    #.#....#.#
    ..######.#

    Tile 2539:
    ##.#...#..
    ..#..#.##.
    #.....#...
    #...#.#...
    .........#
    #.........
    ......#..#
    #......#.#
    ......#.#.
    .#..##....

    Tile 2269:
    #.##.#..##
    #.......##
    .#...#.##.
    .##......#
    .##.##....
    #..#...#..
    .#..#...#.
    ###.....#.
    #......###
    ...#####.#

    Tile 1583:
    .##.####.#
    ...#....##
    .........#
    .....#...#
    .#...##.##
    #.....#..#
    .#.#.#....
    ...#..#.#.
    #..#.#...#
    #.#..#.###

    Tile 2749:
    .#..#...#.
    ....##.###
    ##...#....
    #.#..##.##
    #.#..#....
    .#.#..#..#
    #...#..#..
    ####..#..#
    #.#.#..#.#
    #..##.##..

    Tile 1613:
    #.#.#.#..#
    ....#.##.#
    ....#.....
    .#...###.#
    .###.##..#
    ###.#.....
    #.#....#.#
    ..#..#...#
    #...#...#.
    #.##.####.

    Tile 1823:
    ...####..#
    #....#...#
    .....##.#.
    ....#.#..#
    .#..##..##
    #####.....
    ....##....
    #....#...#
    ....#.....
    ...#.#.#.#

    Tile 3821:
    .#####.###
    ##....##..
    ##.#.##..#
    .##...#..#
    .##.....##
    ...#..#...
    ......#..#
    .....#...#
    .#.####.#.
    ..#.#....#

    Tile 1451:
    #..#..###.
    ###...#...
    .......##.
    .#......##
    #.#.......
    ...#.....#
    #.........
    ##....##..
    #......###
    ##...###.#

    Tile 1913:
    #########.
    #........#
    #.##..#..#
    .###.....#
    ##.......#
    ###.......
    .....#...#
    #...#.....
    #.##......
    ..#.#..###

    Tile 1307:
    .#.##.#.#.
    #..#..##.#
    #.#...#..#
    ...#..#..#
    #...#.....
    #...#....#
    .......##.
    ....#.....
    ...#.#....
    ##.###.#..

    Tile 1777:
    ..#..##..#
    ##....#...
    #...#..#..
    .##...#..#
    ###.##.#.#
    ........##
    .....#....
    ##.....#..
    ..#..#.#..
    .##..##...

    Tile 3011:
    #.#..##.#.
    #.....#..#
    .###...#..
    ..........
    #.....#...
    ...#.#....
    #..#.....#
    ...#..##.#
    #......#.#
    ...###....

    Tile 2459:
    #.##.##.##
    .##.#....#
    .....#.#.#
    #.##...#..
    .###.#.#..
    .##.......
    #.#..#....
    .#.....#..
    #.#...#.##
    #.####.###

    Tile 1123:
    ....#...##
    ..###.#.#.
    ....#.....
    #.#..#..##
    #.#..#..#.
    .#..#.####
    ....#.###.
    #..#.....#
    ........##
    .####.....

    Tile 3917:
    ##.#.#.###
    .........#
    ........#.
    .....#....
    .#.....#.#
    #.....#.#.
    #..#...#..
    #.........
    #........#
    #####..#.#

    Tile 2287:
    ##.##.###.
    ##.....###
    ..#.....#.
    #.....#.#.
    #..#.#.###
    .#...#...#
    #..###..#.
    #..##.....
    ###...#..#
    #..####.##

    Tile 1471:
    #.##...#..
    .##.#.#..#
    #.......##
    .......###
    ....#.#...
    ##.......#
    #....#...#
    #....###..
    .##.#.##..
    ####.#....

    Tile 2357:
    ####......
    ..#.......
    #.#...#..#
    #.........
    ..........
    ##..#..#..
    .#..###...
    ..#..##...
    ##....###.
    ##...#....

    Tile 1319:
    ###...###.
    ..#..#....
    #..#.....#
    ......#.##
    .........#
    ...#....#.
    ###..#...#
    ###..##..#
    ....##.#..
    #...#.....

    Tile 3467:
    ..#...#...
    .#.....#.#
    ..#......#
    ..#......#
    #..#....#.
    .#....#.#.
    ##..#.....
    ###....#..
    #.....##..
    ##...#...#

    Tile 3407:
    .###..####
    #....#...#
    #.........
    ..#....#.#
    ..#.....##
    .#.....#.#
    ..#.#..#..
    #..#.##...
    .#....##..
    .#####.###

    Tile 2801:
    #..##..##.
    ..#.....##
    .....#....
    ..#...##..
    #.#....#.#
    #....#.#.#
    ..#...#.##
    #.#..##..#
    #...#.#..#
    ##.....#.#

    Tile 1021:
    ......#.#.
    ...#...#..
    #.#......#
    ##..#..#.#
    ##..#.....
    ..#..#..#.
    ......##.#
    ......##..
    ..##......
    ##....#...

    Tile 3677:
    #.#.......
    #...#.##.#
    ....#..#.#
    .#...#....
    ..........
    .........#
    ..#..#.#.#
    #.#.##...#
    ..##.....#
    #.##.##.##

    Tile 1321:
    .#.#...#.#
    #..##...##
    #.#.....#.
    ###.......
    #........#
    .#..#....#
    #.##.##...
    #.#....##.
    .##.....##
    #.#####...

    Tile 1607:
    ....###..#
    ..#...#...
    .#.......#
    #...#.....
    ...#......
    #.........
    #...#.....
    ........##
    ##...#...#
    #....#.#.#

    Tile 1979:
    ##.#.#....
    .#..#...##
    #.......#.
    ..........
    ..#...#...
    .....#...#
    .........#
    ...#..###.
    .###......
    #####..#..

    Tile 2927:
    #.##..###.
    #.#......#
    ......#...
    ...#....##
    #....##...
    ##.......#
    #..#..#...
    ....#..#..
    #...#.#..#
    #.###.....

    Tile 3203:
    #.#..#..#.
    .#.#......
    ....##..#.
    ....######
    #........#
    ..#......#
    ##.#...#..
    #......#.#
    #.....#.##
    .##..###.#

    Tile 3323:
    ##..###.#.
    .......#.#
    .........#
    #.........
    ........#.
    .........#
    ###......#
    ..........
    #...#.#..#
    .##.#.###.

    Tile 1489:
    .#...##.#.
    ........##
    .##.#...##
    .......#.#
    #.##.#.#.#
    .##....##.
    #....#..#.
    #..#.....#
    ##.#.##.##
    .#.#.#....

    Tile 2273:
    ####.#..#.
    ##.#......
    ##..###.##
    .##..#....
    #..#.#...#
    ##...#....
    #.#...#.#.
    #..#.....#
    ##.#..#.#.
    ##...#..#.

    Tile 2293:
    .#.##.#...
    ..#.#.#.#.
    .......###
    #.#....#..
    #......#.#
    ##..##.#.#
    ######..##
    #.....#...
    ##....#..#
    #.#####.##

    Tile 1301:
    #.....##..
    #..#.....#
    #......#.#
    #....#....
    ##.#.#..##
    ......#...
    #.........
    #........#
    #..#.....#
    ###..##...

    Tile 1229:
    .#..####..
    ##.....##.
    ##........
    #...#.....
    .#....#.#.
    #.........
    ..#......#
    ##..##.#.#
    #####....#
    #..#.###..

    Tile 3769:
    .#..#.##.#
    ##.....#.#
    #.#...#..#
    ..#..##..#
    #.##.#####
    .....##.#.
    #.#.####..
    .###...#..
    #.#...#..#
    .#.####...

    Tile 3319:
    ######.###
    ....#...##
    #..##..#.#
    ##.....#..
    #.#.##..#.
    #.#.#.....
    .........#
    #.#.#..###
    ....#..#.#
    ####....#.

    Tile 3547:
    ##..#..##.
    #.....#...
    .#.......#
    .......#.#
    #.....#..#
    #..##.#.#.
    ....#.#...
    ....#..#..
    .....#....
    ...#.#..##

    Tile 3643:
    ....####.#
    ...#......
    .##......#
    #...#.....
    .......##.
    ##.......#
    ......##.#
    #.....#...
    #.#.......
    ######...#

    Tile 1103:
    #...#.#.#.
    .........#
    .....#....
    .......#..
    #......###
    ##......##
    #..#.....#
    #.#.....#.
    #...#...##
    .#.#...#.#

    Tile 2711:
    ###.##.##.
    ....#...#.
    ##.......#
    #.....#...
    #...#.#.##
    #..##.#...
    ..#....###
    ...#....##
    .##.#####.
    .##.##.#.#

    Tile 1871:
    #.###.####
    .........#
    #......#.#
    ..##....##
    #..#..##.#
    #..###...#
    #.#.....##
    ......#.#.
    .#.#.....#
    #.#.#.....

    Tile 3851:
    ..##.##.#.
    .....#.#..
    #....#...#
    #..#..#..#
    ###.....#.
    #.#..#..##
    ..#......#
    .##.#....#
    #....##.#.
    .##..#.#.#

    Tile 1151:
    ###......#
    ...##.....
    ....#.....
    ....#.....
    #..#..#...
    ##....##..
    ..#......#
    .#.....#.#
    ........##
    .##.#..#.#

    Tile 2377:
    .##.##.#.#
    .....##.##
    ###.......
    #....##..#
    ##......#.
    ...#.##..#
    #...#....#
    .##..#.##.
    #.###...#.
    .#.#..##..

    Tile 3581:
    ..#.#....#
    ..#.#..#..
    .##..#.##.
    #.##..##..
    #.....#...
    #..#...###
    ...#......
    #.#.......
    ####......
    #.#...####

    Tile 1303:
    ##.#.#....
    #.#.#.##.#
    ..#......#
    .##.##...#
    ##..#..#..
    #...#.#.##
    ##..#.#..#
    ..##.#....
    #.........
    .#.#..##.#

    Tile 2843:
    ##.##..##.
    #..##.##.#
    #...#....#
    #..#.####.
    #...#.....
    ##....#..#
    #...#.....
    ..#..###..
    #..#..#..#
    ##..##...#

    Tile 3617:
    ##...##..#
    .#..#...#.
    .##......#
    #.####...#
    ##........
    #.........
    #......#..
    ##...#....
    #.##..#..#
    .##..##...

    Tile 1091:
    ######..#.
    ....#.#..#
    .....#...#
    #....#...#
    ......#.##
    ...#.##...
    #...#.....
    ..#.###...
    #....#..##
    #.###..#..

    Tile 1213:
    .##..#.#.#
    .#..#..#..
    ##.#.#....
    #....##..#
    ##........
    ##..#.....
    #...#..#..
    #...#..#..
    #.......#.
    #.....#.##

""".trimIndent()